class s{constructor(){this.storageKey="user_preferences",this.defaultPreferences={language:"fr",theme:"light",autoTheme:!0},this.loadPreferences()}loadPreferences(){try{const e=localStorage.getItem(this.storageKey);e?this.preferences={...this.defaultPreferences,...JSON.parse(e)}:this.preferences={...this.defaultPreferences}}catch{this.preferences={...this.defaultPreferences}}}savePreferences(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.preferences))}catch{}}getPreference(e){return this.preferences[e]}setPreference(e,t){this.preferences[e]=t,this.savePreferences(),this.applyPreferences()}getAllPreferences(){return{...this.preferences}}applyPreferences(){this.applyTheme(),this.applyLanguage()}applyTheme(){const{theme:e,autoTheme:t}=this.preferences;if(t){const r=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";document.documentElement.setAttribute("data-theme",r)}else document.documentElement.setAttribute("data-theme",e)}applyLanguage(){const{language:e}=this.preferences;document.documentElement.setAttribute("lang",e),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}}))}listenToSystemTheme(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{this.preferences.autoTheme&&this.applyTheme()})}init(){this.applyPreferences(),this.listenToSystemTheme()}}const a=new s;export{a as p};
