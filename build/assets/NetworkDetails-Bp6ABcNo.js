import{r as d,j as e,u as ee,v as se,T as o,w as te,B as c,G as W,i as v,M as A,al as de,A as he,aT as re,aU as xe,x as ae,n as R,C as le,aV as ys,U as Se,I as J,aW as _s,a2 as nt,a3 as ts,aX as rs,X as as,S as Cs,z as ot,aY as is,D as oe,g as dt,h as ze,aZ as ct,a_ as ut,l as we,O as ws,a$ as mt,aS as ls,b0 as pt,ag as ht,aP as xt,F as ns,s as os,t as ds}from"./mui-mRVmBbre.js";import{n as Is,i as t,l as Ue,o as ft,b as bt,c as gt,L as vt,N as jt,p as cs,G as us,T as ms,C as ps,S as hs,g as xs,Q as fs,a as G,h as yt,m as _t,y as pe}from"./index-tM-Ac5N7.js";import{A as Ct}from"./AccessControl-DiRRByFc.js";import{S as wt}from"./SecureErrorMessage-C13siMY2.js";import{D as bs}from"./DeleteConfirmDialog-CIKPnhKB.js";import{p as ke,a as Le,f as Ie}from"./themeService-BmrTQJz0.js";import{f as gs}from"./utils-DP_tgNw_.js";import{f as vs}from"./fr-CiOJZWTq.js";import"./preferencesService-CpvhBlZK.js";import{d as It}from"./router-BwhLjOj0.js";import"./vendor-Bzgz95E1.js";import"./redux-DbjaNwcH.js";const St=({open:p,onClose:B,onSave:I,networkData:_,isLoading:C=!1})=>{const[l,z]=d.useState({date:new Date,type_culte:"",groupes_previsions:{}}),[b,K]=d.useState(0),[O,Q]=d.useState({});d.useEffect(()=>{if(_?.grs&&Array.isArray(_.grs)){const h={};_.grs.forEach(S=>{const q=S.members?.length||0,U=S.nom||`GR ${S.responsable1?.username?.split(" ")[0]||"Sans nom"}${S.responsable2?.username?` & ${S.responsable2?.username?.split(" ")[0]}`:""}`;h[S.id]={id:S.id,nom:U,effectif_actuel:q,valeur_previsionnelle:q}}),z(S=>({...S,groupes_previsions:h}))}},[_]),d.useEffect(()=>{const h=Object.values(l.groupes_previsions).reduce((S,q)=>S+(parseInt(q.valeur_previsionnelle)||0),0);K(h)},[l.groupes_previsions]);const H=(h,S)=>{const q=parseInt(S)||0;z(U=>({...U,groupes_previsions:{...U.groupes_previsions,[h]:{...U.groupes_previsions[h],valeur_previsionnelle:q}}}))},M=()=>{const h={};return l.date||(h.date=t.t("errors.validation.dateRequired")),l.type_culte||(h.type_culte=t.t("errors.validation.typeCulteRequired")),Object.values(l.groupes_previsions).some(q=>(parseInt(q.valeur_previsionnelle)||0)>0)||(h.previsions=t.t("previsionnel.errors.noPrevision")),Q(h),Object.keys(h).length===0},u=()=>{if(!M())return;const h=b+(l.invites||0),S={date:l.date.toISOString(),type_culte:l.type_culte,total_prevu:h,invites:l.invites||0,network_id:_.reseau.id,church_id:_.reseau.church_id||_.reseau.eglise_id,groupes_previsions:Object.values(l.groupes_previsions).map(q=>({group_id:q.id,effectif_actuel:q.effectif_actuel,valeur_previsionnelle:q.valeur_previsionnelle}))};I(S)},Y=()=>{Q({}),B()},V=Is.filter(h=>h.value!=="Tous");return e.jsxs(ee,{open:p,onClose:Y,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{height:"90vh"}},children:[e.jsxs(se,{children:[e.jsx(o,{variant:"h5",component:"div",children:t.t("previsionnel.modal.title")}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:[t.t("previsionnel.modal.subtitle")," - ",_?.reseau?.nom]})]}),e.jsxs(te,{dividers:!0,sx:{p:3},children:[e.jsx(c,{component:"form",sx:{mb:3},children:e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(v,{fullWidth:!0,id:"previsionnel-form-date",name:"date",type:"date",label:t.t("previsionnel.form.date"),value:l.date?l.date.toISOString().split("T")[0]:"",onChange:h=>z(S=>({...S,date:new Date(h.target.value)})),error:!!O.date,helperText:O.date,required:!0,InputLabelProps:{shrink:!0},sx:{minWidth:200},autoComplete:"off"})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(v,{select:!0,fullWidth:!0,id:"previsionnel-form-type-culte",name:"type_culte",label:t.t("previsionnel.form.typeCulte"),value:l.type_culte,onChange:h=>z(S=>({...S,type_culte:h.target.value})),error:!!O.type_culte,helperText:O.type_culte,required:!0,sx:{minWidth:200},autoComplete:"off",children:V.map(h=>e.jsx(A,{value:h.value,children:h.label},h.value))})})]})}),e.jsx(de,{sx:{my:3}}),O.previsions&&e.jsx(he,{severity:"error",sx:{mb:3},children:O.previsions}),e.jsxs(c,{sx:{mb:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:t.t("previsionnel.form.groupes")}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.t("previsionnel.form.groupesDescription")}),e.jsx(W,{container:!0,spacing:2,children:Object.values(l.groupes_previsions).map(h=>e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(re,{variant:"outlined",sx:{height:"100%"},children:e.jsxs(xe,{children:[e.jsx(o,{variant:"subtitle1",gutterBottom:!0,children:h.nom}),e.jsx(c,{sx:{mb:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:[t.t("previsionnel.form.totalMembres")," : ",e.jsx("strong",{children:h.effectif_actuel})]})}),e.jsx(v,{fullWidth:!0,id:`previsionnel-form-groupe-${h.id}`,name:`groupe_${h.id}`,type:"number",variant:"outlined",label:t.t("previsionnel.form.valeurPrevisionnelle"),value:h.valeur_previsionnelle,onChange:S=>H(h.id,S.target.value),inputProps:{min:0},size:"small",autoComplete:"off"})]})})},h.id))})]}),e.jsx(de,{sx:{my:3}}),e.jsxs(c,{sx:{mb:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:t.t("previsionnel.form.invites")}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.t("previsionnel.form.invitesDescription")}),e.jsx(v,{fullWidth:!0,id:"previsionnel-form-invites",name:"invites",type:"number",label:t.t("previsionnel.form.nombreInvites"),value:l.invites||0,onChange:h=>z(S=>({...S,invites:parseInt(h.target.value)||0})),inputProps:{min:0},sx:{maxWidth:300},autoComplete:"off"})]}),e.jsx(de,{sx:{my:3}})]}),e.jsxs(ae,{sx:{p:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(o,{variant:"h6",sx:{fontWeight:"bold"},children:[t.t("previsionnel.form.totalPrevisionnel")," : ",e.jsx("strong",{children:b+(l.invites||0)})]}),e.jsxs(c,{children:[e.jsx(R,{onClick:Y,disabled:C,sx:{mr:1},children:t.t("common.actions.cancel")}),e.jsx(R,{variant:"contained",onClick:u,disabled:C||b+(l.invites||0)===0,children:C?t.t("common.actions.loading"):t.t("previsionnel.form.save")})]})]})]})},kt=({open:p,onClose:B,networkData:I,onSave:_,isLoading:C=!1})=>{const[l,z]=d.useState({date:new Date().toISOString().split("T")[0],type_culte:"",groupes_assistance:{},invites:0}),[b,K]=d.useState(!1),[O,Q]=d.useState(null),[H,M]=d.useState(null),[u,Y]=d.useState(0);d.useEffect(()=>{if(p&&I?.grs&&Array.isArray(I.grs)){const x={};I.grs.forEach(g=>{const N=g.members?.length||0,T=g.nom||`GR ${g.responsable1?.username?.split(" ")[0]||"Sans nom"}${g.responsable2?.username?` & ${g.responsable2?.username?.split(" ")[0]}`:""}`;x[g.id]={id:g.id,nom:T,effectif_actuel:N,nombre_presents:N}}),z(g=>({...g,groupes_assistance:x}))}},[p,I]),d.useEffect(()=>{(async()=>{if(l.date&&l.type_culte&&I?.reseau?.id)try{const g=await ke.getStats({network_id:I.reseau.id,date_from:l.date,date_to:l.date,type_culte:l.type_culte});g.data&&g.data.details&&g.data.details.length>0?M(g.data.details[0]):M(null)}catch{M(null)}})()},[l.date,l.type_culte,I?.reseau?.id]),d.useEffect(()=>{const x=Object.values(l.groupes_assistance).reduce((g,N)=>g+(N.nombre_presents||0),0);Y(x)},[l.groupes_assistance]);const V=(x,g)=>{z(N=>({...N,[x]:g}))},h=(x,g,N)=>{z(T=>({...T,groupes_assistance:{...T.groupes_assistance,[x]:{...T.groupes_assistance[x],[g]:N}}}))},S=async()=>{K(!0),Q(null);try{if(!l.date||!l.type_culte)throw new Error("Veuillez remplir tous les champs obligatoires");if(u===0)throw new Error("Veuillez saisir au moins un prÃ©sent");const x={date:new Date(l.date).toISOString(),type_culte:l.type_culte,total_presents:u+(l.invites||0),invites:l.invites||0,network_id:I.reseau.id,church_id:I.reseau.church_id||I.reseau.eglise_id,groupes_assistance:Object.values(l.groupes_assistance).map(g=>({group_id:g.id,effectif_actuel:g.effectif_actuel,nombre_presents:g.nombre_presents}))};_(x)}catch(x){Q(x.response?.data?.message||x.message||"Erreur lors de l'enregistrement")}finally{K(!1)}},q=()=>{Q(null),M(null),B()},U=H?u-H.previsionnel:null,L=Is.filter(x=>x.value!=="Tous");return e.jsxs(ee,{open:p,onClose:q,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{height:"90vh"}},children:[e.jsxs(se,{children:[e.jsx(o,{variant:"h5",component:"div",children:t.t("assistance.form.title")}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:[t.t("assistance.form.subtitle")," - ",I?.reseau?.nom]})]}),e.jsxs(te,{dividers:!0,sx:{p:3},children:[e.jsx(c,{component:"form",sx:{mb:3},children:e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(v,{fullWidth:!0,id:"assistance-form-date",name:"date",type:"date",label:t.t("assistance.form.date"),value:l.date,onChange:x=>V("date",x.target.value),InputLabelProps:{shrink:!0},sx:{minWidth:200},autoComplete:"off"})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(v,{select:!0,fullWidth:!0,id:"assistance-form-type-culte",name:"type_culte",label:t.t("assistance.form.typeCulte"),value:l.type_culte,onChange:x=>V("type_culte",x.target.value),sx:{minWidth:200},autoComplete:"off",children:L.map(x=>e.jsx(A,{value:x.value,children:x.label},x.value))})})]})}),e.jsx(de,{sx:{my:3}}),O&&e.jsx(he,{severity:"error",sx:{mb:3},children:O}),e.jsxs(c,{sx:{mb:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:t.t("assistance.form.groupes")}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.t("assistance.form.groupesDescription")}),e.jsx(W,{container:!0,spacing:2,children:Object.values(l.groupes_assistance).map(x=>e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(re,{variant:"outlined",sx:{height:"100%"},children:e.jsxs(xe,{children:[e.jsx(o,{variant:"subtitle1",gutterBottom:!0,children:x.nom}),e.jsx(c,{sx:{mb:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:[t.t("assistance.form.totalMembres")," : ",e.jsx("strong",{children:x.effectif_actuel})]})}),e.jsx(v,{fullWidth:!0,id:`assistance-form-groupe-${x.id}`,name:`groupe_${x.id}`,type:"number",variant:"outlined",label:t.t("assistance.form.nombrePresents"),value:x.nombre_presents||"",onChange:g=>h(x.id,"nombre_presents",parseInt(g.target.value)||0),inputProps:{min:0,max:x.effectif_actuel},size:"small",autoComplete:"off"})]})})},x.id))})]}),e.jsx(de,{sx:{my:3}}),e.jsxs(c,{sx:{mb:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:t.t("assistance.form.invites")}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.t("assistance.form.invitesDescription")}),e.jsx(v,{fullWidth:!0,id:"assistance-form-invites",name:"invites",type:"number",label:t.t("assistance.form.nombreInvites"),value:l.invites||0,onChange:x=>z(g=>({...g,invites:parseInt(x.target.value)||0})),inputProps:{min:0},sx:{maxWidth:300},autoComplete:"off"})]}),e.jsx(de,{sx:{my:3}}),H&&e.jsxs(c,{sx:{mb:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:t.t("assistance.form.comparisonTitle")}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.t("assistance.form.comparisonDescription")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsxs(re,{variant:"outlined",sx:{p:2,textAlign:"center"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:t.t("assistance.form.previsionnel")}),e.jsx(o,{variant:"h6",color:"primary",children:H.previsionnel})]})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsxs(re,{variant:"outlined",sx:{p:2,textAlign:"center"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:t.t("assistance.form.presents")}),e.jsx(o,{variant:"h6",color:"success.main",children:u})]})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsxs(re,{variant:"outlined",sx:{p:2,textAlign:"center"},children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:t.t("assistance.form.ecart")}),e.jsx(le,{label:U>=0?`+${U}`:U,color:U>=0?"success":"error",size:"medium"})]})})]})]})]}),e.jsxs(ae,{sx:{p:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(o,{variant:"h6",sx:{fontWeight:"bold"},children:[t.t("assistance.form.totalPresents")," : ",e.jsx("strong",{children:u+(l.invites||0)}),l.invites>0&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:["(",u," membres + ",l.invites," invitÃ©s)"]})]}),e.jsxs(c,{children:[e.jsx(R,{onClick:q,disabled:C,sx:{mr:1},children:t.t("common.actions.cancel")}),e.jsx(R,{variant:"contained",onClick:S,disabled:C||u===0,children:C?t.t("common.actions.loading"):t.t("assistance.form.save")})]})]})]})},At=({open:p,onClose:B,networkData:I})=>{const[_,C]=d.useState(0),[l,z]=d.useState(!1),[b,K]=d.useState([]),[O,Q]=d.useState([]),[H,M]=d.useState(null),[u,Y]=d.useState({open:!1,type:null,item:null,title:"",content:""}),[V,h]=d.useState({open:!1,message:"",severity:"success"});d.useEffect(()=>{p&&I?.reseau?.id&&S()},[p,I]),d.useEffect(()=>{if(p){const m=setTimeout(()=>{const E=document.querySelector('[role="dialog"]');E&&E.focus()},100);return()=>clearTimeout(m)}},[p]);const S=async()=>{if(I?.reseau?.id){z(!0),M(null);try{const m=await ke.getStats({network_id:I.reseau.id,limit:50}),E=await Le.getStats({network_id:I.reseau.id,limit:50}),$=m.data?.details||m.data?.data||[],ie=E.data?.details||E.data?.data||[];K($),Q(ie)}catch(m){Ue.error("Erreur lors du chargement de l'historique:",m),M(t.t("history.loadingError"))}finally{z(!1)}}},q=async()=>{if(u.item)try{if(u.type==="previsionnel"){const m=u.item.id;if(!m){h({open:!0,message:"ID du prÃ©visionnel manquant",severity:"error"});return}await ke.delete(m),K(E=>E.filter($=>$.id!==m)),h({open:!0,message:t.t("history.deletePrevisionnelSuccess"),severity:"success"})}else if(u.type==="assistance"){const m=u.item.id;if(!m){h({open:!0,message:"ID de l'assistance manquant",severity:"error"});return}await Le.delete(m),Q(E=>E.filter($=>$.id!==m)),h({open:!0,message:t.t("history.deleteAssistanceSuccess"),severity:"success"})}Y({open:!1,type:null,item:null,title:"",content:""})}catch(m){Ue.error("â Erreur lors de la suppression:",m),h({open:!0,message:t.t("history.deleteError"),severity:"error"})}},U=(m,E)=>{const $=m==="previsionnel",ie=gs(new Date(E.date),"dd/MM/yyyy",{locale:vs}),Ae=E.type_culte||t.t("history.defaultCulteType");Y({open:!0,type:m,item:E,title:`Supprimer ${$?"le prÃ©visionnel":"l'assistance"}`,content:`Ãtes-vous sÃ»r de vouloir supprimer ${$?"le prÃ©visionnel":"l'assistance"} du ${ie} (${Ae}) ?`})},L=()=>{h(m=>({...m,open:!1}))},x=m=>{try{return gs(new Date(m),"dd/MM/yyyy",{locale:vs})}catch{return m}},g=m=>({CULTE_DIMANCHE:t.t("previsionnel.form.typeCulte.dimanche"),CULTE_MERCREDI:t.t("previsionnel.form.typeCulte.mercredi"),CULTE_VENDREDI:t.t("previsionnel.form.typeCulte.vendredi"),CULTE_SPECIAL:t.t("previsionnel.form.typeCulte.special"),REUNION_PRIERE:t.t("previsionnel.form.typeCulte.reunionPriere"),ETUDE_BIBLIQUE:t.t("previsionnel.form.typeCulte.etudeBiblique")})[m]||m,N=m=>e.jsx(re,{sx:{mb:1.5,"&:hover":{boxShadow:2}},children:e.jsx(xe,{sx:{p:2},children:e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(is,{color:"primary",sx:{fontSize:"1.2rem"}}),e.jsxs(c,{children:[e.jsx(o,{variant:"subtitle1",color:"primary",sx:{fontSize:"1rem"},children:x(m.date)}),e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2,mt:.5},children:[e.jsx(le,{label:g(m.type_culte),color:"primary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:"bold"}}),e.jsx(le,{label:`${t.t("previsionnel.form.totalMembres")} : ${m.previsionnel||m.total_previsionnel||0}`,color:"primary",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:"bold"}})]})]})]}),e.jsx(c,{sx:{display:"flex",gap:1},children:e.jsx(Se,{title:t.t("common.actions.delete"),children:e.jsx(J,{color:"error",size:"small",onClick:()=>U("previsionnel",m),children:e.jsx(oe,{})})})})]})})}),T=m=>e.jsx(re,{sx:{mb:1.5,"&:hover":{boxShadow:2}},children:e.jsx(xe,{sx:{p:2},children:e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(is,{color:"success",sx:{fontSize:"1.2rem"}}),e.jsxs(c,{children:[e.jsx(o,{variant:"subtitle1",color:"success.main",sx:{fontSize:"1rem"},children:x(m.date)}),e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2,mt:.5},children:[e.jsx(le,{label:g(m.type_culte),color:"success",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:"bold"}}),e.jsx(le,{label:`${t.t("previsionnel.form.totalMembres")} : ${m.effectif_reel||m.total_presents||0}`,color:"success",variant:"outlined",size:"small",sx:{fontSize:"0.8rem",fontWeight:"bold"}})]})]})]}),e.jsx(c,{sx:{display:"flex",gap:1},children:e.jsx(Se,{title:t.t("common.actions.delete"),children:e.jsx(J,{color:"error",size:"small",onClick:()=>U("assistance",m),children:e.jsx(oe,{})})})})]})})},m.id),fe=()=>l?e.jsx(c,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(ot,{})}):H?e.jsx(he,{severity:"error",sx:{m:2},children:H}):_===0?!Array.isArray(b)||b.length===0?e.jsxs(c,{sx:{textAlign:"center",p:4},children:[e.jsx(rs,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(o,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:t.t("previsionnel.dashboard.noData")}),e.jsx(o,{variant:"body2",color:"text.secondary",children:t.t("previsionnel.dashboard.noDataDescription")})]}):e.jsx(c,{sx:{p:2},children:b.map((m,E)=>e.jsx("div",{children:N(m)},m.id||`${m.date}-${m.type_culte}-${E}`))}):!Array.isArray(O)||O.length===0?e.jsxs(c,{sx:{textAlign:"center",p:4},children:[e.jsx(as,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(o,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:t.t("assistance.dashboard.noData")}),e.jsx(o,{variant:"body2",color:"text.secondary",children:t.t("assistance.dashboard.noDataDescription")})]}):e.jsx(c,{sx:{p:2},children:O.map((m,E)=>e.jsx("div",{children:T(m)},m.id||`${m.date}-${m.type_culte}-${E}`))});return e.jsxs(e.Fragment,{children:[e.jsxs(ee,{open:p,onClose:B,maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!1,disableRestoreFocus:!1,keepMounted:!1,PaperProps:{sx:{minHeight:"70vh"}},children:[e.jsx(se,{children:e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(o,{variant:"h5",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ys,{color:"primary"}),t.t("home.historyOfCultes")]}),e.jsx(c,{sx:{display:"flex",gap:1},children:e.jsx(Se,{title:t.t("common.actions.refresh"),children:e.jsx(J,{onClick:S,disabled:l,children:e.jsx(_s,{})})})})]})}),e.jsxs(te,{children:[e.jsx(c,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:e.jsxs(nt,{value:_,onChange:(m,E)=>C(E),sx:{mb:-1},children:[e.jsx(ts,{label:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(rs,{fontSize:"small"}),t.t("home.previsions")," (",Array.isArray(b)?b.length:0,")"]})}),e.jsx(ts,{label:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(as,{fontSize:"small"}),t.t("home.assistance")," (",Array.isArray(O)?O.length:0,")"]})})]})}),fe()]}),e.jsx(ae,{children:e.jsx(R,{onClick:B,color:"primary",children:t.t("common.close")})})]}),e.jsxs(ee,{open:u.open,onClose:()=>Y({open:!1,type:null,item:null,title:"",content:""}),disableEscapeKeyDown:!1,disableRestoreFocus:!1,keepMounted:!1,children:[e.jsx(se,{children:u.title}),e.jsx(te,{children:e.jsx(o,{children:u.content})}),e.jsxs(ae,{children:[e.jsx(R,{onClick:()=>Y({open:!1,type:null,item:null,title:"",content:""}),children:t.t("common.actions.cancel")}),e.jsx(R,{onClick:q,color:"error",variant:"contained",children:t.t("common.actions.delete")})]})]}),e.jsx(Cs,{open:V.open,autoHideDuration:4e3,onClose:L,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(he,{onClose:L,severity:V.severity,sx:{width:"100%"},children:V.message})})]})},Mt=ws(re)(({theme:p})=>({height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s ease-in-out","&:hover":{transform:"translateY(-4px)"}})),Fe=ws(ze)(({theme:p})=>({padding:p.spacing(2),textAlign:"center",height:"100%",minWidth:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:p.spacing(1)})),Et=p=>[{key:"12",label:"12",value:p[12]||0},{key:"144",label:"144",value:p[144]||0},{key:"1728",label:"1728",value:p[1728]||0},{key:"totalGroups",label:t.t("networks.details.stats.totalGroups"),value:p.totalGroups||0},{key:"Responsables de GR",label:t.t("networks.details.stats.groupResponsibles"),value:p["Responsables de GR"]||0},{key:"Leader",label:t.t("networks.details.stats.leaders"),value:p.Leader||0},{key:"Leader (Tous)",label:t.t("networks.details.stats.allLeaders"),value:p["Leader (Tous)"]||0},{key:"Membre simple",label:t.t("networks.details.stats.simpleMembers"),value:p["Membre simple"]||0}].filter(B=>B.value>0),js=p=>{if(!p)return"";const B=_t.map(l=>l.value),I=p.split(" "),_=I[0];return B.includes(_)?I.length>=2?I[1]:_:I[0]},Bt=()=>{const{user:p,isAuthenticated:B}=ft(),{id:I}=It(),{selectedChurch:_}=bt();d.useEffect(()=>{t.init()},[]);const{canCreateGroups:C,canUpdateGroups:l,canDeleteGroups:z,canUpdateUsers:b,isAdmin:K,isManager:O,isSuperAdmin:Q,isCollecteurReseaux:H}=gt(),M={isAdmin:K,isManager:O,isSuperAdmin:Q,isCollecteurReseaux:H},u=s=>!s&&M.isAdmin?t.t("dashboard.members.permissions.adminReadOnly"):!s&&M.isManager?t.t("dashboard.members.permissions.managerFullRights"):"",[Y,V]=d.useState([]),[h,S]=d.useState([]),[q,U]=d.useState(null);d.useEffect(()=>{(async()=>{try{const[r,a]=await Promise.all([G.churches.getAll(),G.departments.getAll()]),i=r.data?.data||r.data||[],f=a.data?.data||a.data||[];V(Array.isArray(i)?i:[]),S(Array.isArray(f)?f:[])}catch{V([]),S([])}})()},[]);const[L,x]=d.useState(""),[g,N]=d.useState(""),[T,fe]=d.useState(""),[m,E]=d.useState(""),[$,ie]=d.useState([]),[Ae,Me]=d.useState(""),Ss=s=>{if(!s||!j)return[];const r=[],a=parseInt(s.replace("QUALIFICATION_",""));if(a===12)j.reseau?.responsable1&&r.push({id:j.reseau.responsable1.id||j.reseau.responsable1._id,username:j.reseau.responsable1.username,type:"network_responsible",label:`${j.reseau.responsable1.username} - ${t.t("networks.details.networkResponsible")}`}),j.reseau?.responsable2&&r.push({id:j.reseau.responsable2.id||j.reseau.responsable2._id,username:j.reseau.responsable2.username,type:"network_responsible",label:`${j.reseau.responsable2.username} - ${t.t("networks.details.networkResponsible")}`});else{const f=`QUALIFICATION_${a/12}`;(j.grs?.filter(n=>{const _e=n.responsable1?.qualification,Ce=n.responsable2?.qualification;return _e===f||Ce===f})||[]).forEach(n=>{n.responsable1&&n.responsable1.qualification===f&&r.push({id:n.responsable1.id||n.responsable1._id,username:n.responsable1.username,type:"group_responsible",qualification:n.responsable1.qualification,label:`${n.responsable1.username} - ${n.responsable1.qualification?.replace("QUALIFICATION_","")||t.t("networks.details.group")}`}),n.responsable2&&n.responsable2.qualification===f&&r.push({id:n.responsable2.id||n.responsable2._id,username:n.responsable2.username,type:"group_responsible",qualification:n.responsable2.qualification,label:`${n.responsable2.username} - ${n.responsable2.qualification?.replace("QUALIFICATION_","")||t.t("networks.details.group")}`})})}return r},be=()=>{x(""),N(""),fe(""),E(""),ie([]),Me("")},[ks,ge]=d.useState(!1),[As,ve]=d.useState(!1),[Ms,je]=d.useState(!1),[ne,ce]=d.useState(!1),[Z,Ee]=d.useState(null),[ue,De]=d.useState(null),[Es,Re]=d.useState(!1),[Ds,We]=d.useState(!1),[Rs,$e]=d.useState(!1),[Ws,Be]=d.useState(!1),[qs,Qe]=d.useState(!1),[me,k]=d.useState({open:!1,message:"",severity:"info"}),[y,P]=d.useState({username:"",pseudo:"",email:"",password:"",role:"MEMBRE",genre:"",tranche_age:"",profession:"",ville_residence:"",origine:"",situation_matrimoniale:"",niveau_education:"",departement:"",departement_ids:[],qualification:"",telephone:"",adresse:"",image:""}),[Ts,ye]=d.useState(!1),[w,F]=d.useState({username:"",pseudo:"",genre:"",tranche_age:"",profession:"",ville_residence:"",origine:"",situation_matrimoniale:"",niveau_education:"",departement:"",departement_ids:[],qualification:"",email:"",telephone:"",adresse:"",image:""}),[He,Ve]=d.useState(!1),[Ye,Xe]=d.useState(null),[qe,Je]=d.useState(null),[Ke,Ze]=d.useState(null),[Te,es]=d.useState(null);d.useEffect(()=>{},[w]);const Ps=s=>{const r=s.target.files[0];if(s.target.value="",r){if(!r.type.startsWith("image/")){pe.error(t.t("errors.validation.invalidImageType"));return}if(r.size>5*1024*1024){pe.error(t.t("errors.validation.imageTooLarge"));return}Xe(r);const a=new FileReader;a.onload=i=>{Je(i.target.result)},a.readAsDataURL(r)}},Gs=()=>{Xe(null),Je(null),P(s=>({...s,image:""}))},Os=s=>{const r=s.target.files[0];if(s.target.value="",r){if(!r.type.startsWith("image/")){pe.error(t.t("errors.validation.invalidImageType"));return}if(r.size>5*1024*1024){pe.error(t.t("errors.validation.imageTooLarge"));return}Ze(r);const a=new FileReader;a.onload=i=>{es(i.target.result)},a.readAsDataURL(r)}},Ns=()=>{Ze(null),es(null),F(s=>({...s,image:""}))},[j,Fs]=d.useState({reseau:{},stats:[],grs:[],members:{},available_users:[]}),[zs,Us]=d.useState(!0),[Dt,Rt]=d.useState([]),X=async()=>{try{if(!I){U(t.t("networks.details.missingNetworkId"));return}let s={};if(_?.id||_?._id)s={churchId:_.id||_._id};else if(p?.eglise_locale){let n;typeof p.eglise_locale=="object"?n=p.eglise_locale.id||p.eglise_locale._id:typeof p.eglise_locale=="string"&&(n=p.eglise_locale),n&&n!=="undefined"&&n!=="null"&&(s={churchId:n})}Object.keys(s).length===0&&M.isSuperAdmin&&(s={});let r={},a={},i=[],f=[],D=[];try{const n=await G.networks.getById(I);r=n.data?.data||n.data||{}}catch{}try{const n=await G.networks.getStatsById(I);a=n.data?.data||n.data||{}}catch{}try{const n=await G.networks.getGroups(I);i=n.data?.data||n.data||[]}catch{}try{const n=await G.networks.getMembers(I);f=n.data?.data||n.data||[]}catch{}if(Object.keys(s).length>0)try{const n=await G.users.getAvailable(s);D=n.data?.data||n.data||[]}catch{}Fs({reseau:r,stats:a,grs:Array.isArray(i)?i:[],members:Array.isArray(f)?f:[],available_users:Array.isArray(D)?D:[]})}catch(s){const r=yt(s,"erreur fetchdata:");U(r.message)}finally{Us(!1)}};d.useEffect(()=>{X()},[I]),d.useEffect(()=>{if((p?.current_role||p?.role)!=="SUPER_ADMIN"){let s="";_?.id||_?._id?s=_.id||_._id:p?.eglise_locale&&(s=typeof p.eglise_locale=="object"?p.eglise_locale.id||p.eglise_locale._id:p.eglise_locale),s&&P(r=>({...r,eglise_locale:s}))}},[p,_]),d.useEffect(()=>{if(L||g){const s=Ls(L,g);Me(s)}else Me("")},[L,g,j.available_users]);const Ls=(s,r)=>{if(!s)return"";const a=j.available_users.find(n=>(n.id||n._id)===s),i=j.available_users.find(n=>(n.id||n._id)===r);let f="";return a?a.username?f=js(a.username):f=a.pseudo||"":i&&(i.username?f=js(i.username):f=i.pseudo||""),f?`GR_${f.replace(/[^a-zA-ZÃ-Ã¿0-9\s]/g,"").replace(/\s+/g,"_").trim()}`:""},$s=async s=>{Be(!0);try{await ke.create(s),k({open:!0,message:t.t("previsionnel.success.created"),severity:"success"}),Re(!1),await X()}catch(r){const a=r.response?.data?.message||t.t("errors.api.operation");k({open:!0,message:a,severity:"error"})}finally{Be(!1)}},Bs=async s=>{Qe(!0);try{await Le.create(s),k({open:!0,message:t.t("assistance.success.created"),severity:"success"}),We(!1),await X()}catch(r){const a=r.response?.data?.message||t.t("errors.api.operation");k({open:!0,message:a,severity:"error"})}finally{Qe(!1)}},Qs=()=>{Re(!1)},Hs=()=>{We(!1)},Vs=async s=>{try{const r=s.id||s._id;if(!r){k({open:!0,message:t.t("networks.details.invalidGroupId"),severity:"error"});return}await G.groups.update(r,s),ve(!1),Ee(null),k({open:!0,message:t.t("success.groupUpdated"),severity:"success"}),await X()}catch{k({open:!0,message:t.t("errors.api.updateGroup"),severity:"error"})}},[Ys,Pe]=d.useState(!1),[Xs,Ge]=d.useState(null),Js=s=>{Ge(s),Pe(!0)},Ks=async()=>{try{await G.groups.delete(Xs),await X(),k({open:!0,message:t.t("success.groupDeleted"),severity:"success"})}catch{k({open:!0,message:t.t("errors.api.deleteGroup"),severity:"error"})}finally{Pe(!1),Ge(null)}},Zs=()=>{Pe(!1),Ge(null)},et=async s=>{try{const r={...s,network_id:I,responsable1_id:L,qualification:T,superieur_hierarchique_id:m||null};g&&(r.responsable2_id=g),await G.groups.create(r),ge(!1),k({open:!0,message:t.t("success.groupCreated"),severity:"success"}),await X(),be()}catch(r){if(r.response?.status===401){const a=r.response?.data?.message||"";a.includes("droits")||a.includes("autorisÃ©")||a.includes("Ã©glise")?k({open:!0,message:t.t("errors.permissions.insufficient"),severity:"warning"}):a.includes("token")||a.includes("expirÃ©")||a.includes("Non autorisÃ©")?k({open:!0,message:t.t("errors.session.expired"),severity:"warning"}):k({open:!0,message:a||t.t("errors.authorization"),severity:"warning"})}else r.response?.status===403?k({open:!0,message:r.response?.data?.message||t.t("errors.accessDenied"),severity:"warning"}):k({open:!0,message:r.response?.data?.message||t.t("errors.api.createGroup"),severity:"error"})}},ss=async s=>{try{if(!Z){k({open:!0,message:t.t("networks.details.noGroupSelected"),severity:"error"});return}const r=Z.id||Z._id;if(!r){k({open:!0,message:t.t("networks.details.invalidGroupId"),severity:"error"});return}if(ne){let a=s.image||"";const i={...s,password:s.password||t.t("auth.register.defaultPassword"),role:"MEMBRE",image:a};if((p?.current_role||p?.role)!=="SUPER_ADMIN"){let n="";_?.id||_?._id?n=_.id||_._id:p?.eglise_locale&&(n=typeof p.eglise_locale=="object"?p.eglise_locale.id||p.eglise_locale._id:p.eglise_locale),n&&(i.eglise_locale_id=n)}s.departement_ids&&s.departement_ids.length>0&&(i.departement_ids=s.departement_ids),delete i.eglise_locale,delete i.departement,Object.keys(i).forEach(n=>{i[n]===""&&(i[n]=null)});const f=await G.users.create(i),D=f.data?.data?.id||f.data?.data?._id||f.data?.id||f.data?._id;if(Ye)try{const n=new FormData;n.append("image",Ye);const _e=await G.users.uploadUserImage(D,n),Ce=_e.data?.data?.image||_e.data?.image;Ce&&await G.users.update(D,{image:Ce})}catch(n){Ue.warn("Erreur lors de l'upload de l'image:",n)}await G.groups.addMember(r,D)}else{if(!s.user_id){k({open:!0,message:t.t("networks.details.missingMemberId"),severity:"error"});return}await G.groups.addMember(r,s.user_id)}je(!1),ce(!1),De(null),P({username:"",pseudo:"",email:"",password:"",role:"MEMBRE",genre:"",tranche_age:"",profession:"",ville_residence:"",origine:"",situation_matrimoniale:"",niveau_education:"",departement:"",departement_ids:[],qualification:"",telephone:"",adresse:"",image:""}),k({open:!0,message:t.t("success.memberAdded"),severity:"success"}),await X()}catch(r){let a=t.t("errors.api.addMember");if(r.response?.status===400){const i=r.response?.data?.message;i?a=i:r.response?.data?.error?a=r.response.data.error:a=t.t("errors.validation.invalidData")}else if(r.response?.status===409)a=t.t("errors.user.alreadyExists");else if(r.response?.status===401){const i=r.response?.data?.message||"";i.includes("droits")||i.includes("autorisÃ©")||i.includes("Ã©glise")?a=t.t("errors.permissions.addMember"):i.includes("token")||i.includes("expirÃ©")||i.includes("Non autorisÃ©")?a=t.t("errors.session.expired"):a=i||t.t("errors.authorization")}else if(r.response?.status===403)a=t.t("errors.permissions.addMember");else if(r.response?.status===500){const i=r.response?.data?.error||r.response?.data?.message;i?a=`Erreur serveur: ${i}`:a=t.t("errors.server.internal")}else r.message&&!r.message.includes("Request failed with status code")&&(a=r.message);k({open:!0,message:a,severity:"error"})}},st=async s=>{try{const r=ue;if(!r){k({open:!0,message:t.t("networks.details.userIdNotFound"),severity:"error"});return}let a=s.image||"";if(Ke)try{const f=new FormData;f.append("image",Ke);const D=await G.users.uploadUserImage(r,f);if(a=D.data?.data?.image||D.data?.image,!a)throw new Error("URL de l'image non reÃ§ue")}catch{pe.error(t.t("errors.imageUploadFailed"));return}const i=Object.keys(s).reduce((f,D)=>((D==="user_id"||D==="_id"||D==="id"||s[D]!==""&&s[D]!==void 0&&s[D]!==null)&&(f[D]=s[D]),f),{});a&&(i.image=a),await G.users.update(r,i),ye(!1),F({username:"",pseudo:"",email:"",password:"",genre:"",tranche_age:"",profession:"",ville_residence:"",origine:"",situation_matrimoniale:"",niveau_education:"",departement:"",departement_ids:[],qualification:"",telephone:"",adresse:"",image:""}),k({open:!0,message:t.t("success.memberUpdated"),severity:"success"}),await X()}catch(r){let a=t.t("errors.api.updateMember");if(r.response?.status===400){const i=r.response?.data?.message;i?a=i:r.response?.data?.error?a=r.response.data.error:a=t.t("errors.validation.invalidData")}else if(r.response?.status===404)a=t.t("errors.member.notFound");else if(r.response?.status===403)a=t.t("errors.permissions.updateMember");else if(r.response?.status===500){const i=r.response?.data?.error||r.response?.data?.message;i?a=`Erreur serveur: ${i}`:a=t.t("errors.server.internal")}else r.message&&!r.message.includes("Request failed with status code")&&(a=r.message);k({open:!0,message:a,severity:"error"})}},[tt,Oe]=d.useState(!1),[rt,Ne]=d.useState({grId:null,userId:null});d.useEffect(()=>{if(T&&j){const s=Ss(T);ie(s),m&&(s.some(a=>a.id===m)||E(""))}else ie([]),E("")},[T,j]);const at=(s,r)=>{Ne({grId:s,userId:r}),Oe(!0)},it=async()=>{const{grId:s,userId:r}=rt;try{await G.groups.removeMember(s,r),k({open:!0,message:t.t("success.memberDeleted"),severity:"success"}),await X()}catch(a){let i=t.t("errors.api.deleteMember");if(a.response?.status===400){const f=a.response?.data?.message;f?i=f:a.response?.data?.error?i=a.response.data.error:i=t.t("errors.member.cannotDelete")}else if(a.response?.status===404)i=t.t("errors.memberOrGroup.notFound");else if(a.response?.status===403)i=t.t("errors.permissions.deleteMember");else if(a.response?.status===500){const f=a.response?.data?.error||a.response?.data?.message;f?i=`Erreur serveur: ${f}`:i=t.t("errors.server.internal")}else a.message&&!a.message.includes("Request failed with status code")&&(i=a.message);k({open:!0,message:i,severity:"error"})}finally{Oe(!1),Ne({grId:null,userId:null})}},lt=()=>{Oe(!1),Ne({grId:null,userId:null})};return zs?e.jsx(vt,{titre:t.t("networks.details.loading")}):q?e.jsx(wt,{error:q,title:t.t("errors.loading")}):B?e.jsx(Ct,{allowedRoles:["SUPER_ADMIN","ADMIN","MANAGER","COLLECTEUR_RESEAUX"],children:e.jsxs(c,{sx:{minHeight:"100vh",bgcolor:"background.default"},children:[e.jsx(jt,{}),e.jsxs(dt,{maxWidth:"lg",sx:{mt:4,mb:4},children:[e.jsxs(c,{display:"flex",justifyContent:"space-between",mb:2,children:[e.jsxs(o,{variant:"h4",sx:{mb:4,color:"primary.main",fontWeight:"bold"},children:[t.t("networks.details.title")," - ",j.reseau.nom]}),e.jsx(c,{display:"flex",alignItems:"center",children:e.jsx(Se,{title:t.t("common.actions.refresh"),children:e.jsx(J,{color:"primary",onClick:X,sx:{border:"1px solid #ddd",bgcolor:"#fff","&:hover":{bgcolor:"#f5f5f5"}},children:e.jsx(_s,{})})})})]}),e.jsxs(ze,{"data-aos":"fade-up",sx:{p:3,mb:4},children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"h5",children:t.t("networks.details.networkResponsibles")}),(M.isAdmin||M.isSuperAdmin||M.isCollecteurReseaux||M.isManager)&&e.jsxs(c,{sx:{display:"flex",gap:2},children:[e.jsx(R,{variant:"contained",startIcon:e.jsx(ct,{}),onClick:()=>Re(!0),sx:{backgroundColor:"#2E7D32","&:hover":{backgroundColor:"#1B5E20"}},children:t.t("previsionnel.button.create")}),e.jsx(R,{variant:"contained",startIcon:e.jsx(ut,{}),onClick:()=>We(!0),sx:{backgroundColor:"#1976d2","&:hover":{backgroundColor:"#1565c0"}},children:t.t("assistance.form.save")}),e.jsx(R,{variant:"outlined",startIcon:e.jsx(ys,{}),onClick:()=>$e(!0),sx:{borderColor:"#FF9800",color:"#FF9800","&:hover":{borderColor:"#F57C00",backgroundColor:"#FFF3E0"}},children:t.t("common.history")})]})]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(we,{}),e.jsxs(c,{children:[e.jsx(o,{variant:"subtitle2",children:t.t("networks.details.responsable1")}),e.jsx(o,{children:j.reseau.responsable1?.username})]})]})}),j.reseau.responsable2?.username&&e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(we,{}),e.jsxs(c,{children:[e.jsx(o,{variant:"subtitle2",children:t.t("networks.details.responsable2")}),e.jsx(o,{children:j.reseau.responsable2?.username})]})]})})]})]}),e.jsxs(ze,{"data-aos":"fade-up",sx:{p:3,mb:4},children:[e.jsx(o,{variant:"h5",gutterBottom:!0,children:t.t("networks.details.statistics")}),e.jsxs(W,{container:!0,spacing:2,children:[Et(j.stats||{}).map((s,r)=>e.jsx(W,{item:!0,xs:6,sm:4,md:2,children:e.jsxs(Fe,{children:[e.jsx(o,{variant:"body2",sx:{mb:1},children:s.label}),e.jsx(o,{variant:"h4",color:"primary",children:s.value})]})},r)),e.jsx(W,{item:!0,xs:6,sm:4,md:2,children:e.jsxs(Fe,{children:[e.jsx(o,{variant:"body2",sx:{mb:1},children:t.t("networks.details.groupesReveil")}),e.jsx(o,{variant:"h4",color:"primary",children:j.grs.length})]})}),e.jsx(W,{item:!0,xs:6,sm:4,md:2,children:e.jsxs(Fe,{children:[e.jsx(o,{variant:"body2",sx:{mb:1},children:t.t("networks.details.effectifTotal")}),e.jsx(o,{variant:"h4",color:"primary",children:(()=>{const s=new Set;j.grs?.forEach(i=>{i.members?.forEach(f=>{const D=f?.id||f?._id||f?.user?.id||f?.user?._id;D&&s.add(D)})});const r=j.reseau?.responsable1?.id||j.reseau?.responsable1?._id,a=j.reseau?.responsable2?.id||j.reseau?.responsable2?._id;return r&&s.add(r),a&&s.add(a),s.size})()})]})})]})]}),e.jsxs(c,{"data-aos":"fade-up",sx:{mb:4},children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(o,{variant:"h5",children:t.t("networks.details.groupesReveil")}),(M.isAdmin||M.isSuperAdmin||M.isCollecteurReseaux)&&e.jsx(R,{variant:"contained",startIcon:e.jsx(mt,{}),onClick:()=>{ge(!0),be()},disabled:!C,title:u(C),children:t.t("networks.details.addGR")})]}),e.jsx(W,{container:!0,sx:{mx:"auto"},alignItems:"stretch",children:(Array.isArray(j.grs)?j.grs:[]).map(s=>e.jsx(W,{"data-aos":"fade-up",sx:{width:"100%",padding:"10px 10px 10px 10px","@media (min-width:500px) and (max-width:849px)":{width:"50%"},"@media (min-width:850px) and (max-width:1199px)":{width:"33.33%"},"@media (min-width:1200px) and (max-width:1599px)":{width:"25%"},"@media (min-width:1600px)":{width:"20%"}},children:e.jsxs(Mt,{children:[e.jsxs(xe,{children:[e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"h6",children:s.nom}),(M.isAdmin||M.isSuperAdmin||M.isCollecteurReseaux)&&e.jsxs(c,{children:[e.jsx(J,{color:"primary",onClick:()=>{Ee(s),ve(!0)},disabled:!l,title:u(l),children:e.jsx(ls,{})}),e.jsx(J,{color:"error",onClick:()=>Js(s.id),disabled:!z,title:u(z),children:e.jsx(oe,{})})]})]}),e.jsxs(c,{sx:{mb:2},children:[e.jsx(o,{variant:"subtitle2",children:t.t("networks.details.responsable1")}),e.jsx(o,{children:s.responsable1?.username}),s.responsable2?.username&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"subtitle2",sx:{mt:1},children:t.t("networks.details.responsable2")}),e.jsx(o,{children:s.responsable2?.username})]}),e.jsxs(o,{sx:{mt:1},children:[e.jsx("strong",{children:t.t("networks.details.nombreMembres")})," ",s.members?.length]})]}),s.members?.map(r=>{const i=j.members?.find(f=>(f.user?.id||f.user?._id)===(r.user?.id||r.user?._id))?.user||r.user||{};return e.jsxs(c,{sx:{p:1,mb:1,borderRadius:1,bgcolor:"background.default",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(o,{children:[i.username||t.t("common_text.unknownName")," (",e.jsx(o,{component:"span",variant:"caption",sx:{fontWeight:"bold",fontSize:"0.9rem"},children:Ie(i.qualification,t.t("common.unknown"))}),")"]}),(M.isAdmin||M.isCollecteurReseaux||M.isSuperAdmin)&&e.jsxs(c,{children:[e.jsx(J,{size:"small",onClick:()=>{De(i.id||i._id),F({username:i.username||"",pseudo:i.pseudo||"",genre:i.genre||"",tranche_age:i.tranche_age||"",profession:i.profession||"",ville_residence:i.ville_residence||"",origine:i.origine||"",situation_matrimoniale:i.situation_matrimoniale||"",niveau_education:i.niveau_education||"",departement:i.departement||"",departement_ids:i.user_departments?.map(f=>f.department_id)||[],qualification:i.qualification||"",email:i.email||"",telephone:i.telephone||"",adresse:i.adresse||"",image:i.image||""}),setTimeout(()=>{},100),ye(!0)},disabled:!b,title:u(b),children:e.jsx(ls,{})}),e.jsx(J,{size:"small",color:"error",onClick:()=>at(s.id,i.id||i._id),disabled:!l,title:u(l),children:e.jsx(oe,{})})]})]},r.user?.id||r.user?._id||r._id||`member-${Math.random()}`)})]}),e.jsx(pt,{sx:{mt:"auto",p:2},children:(M.isAdmin||M.isCollecteurReseaux||M.isSuperAdmin)&&e.jsx(R,{fullWidth:!0,variant:"contained",onClick:()=>{Ee(s),je(!0)},disabled:!l,title:u(l),children:t.t("networks.details.addMember")})})]})},s.id))})]}),e.jsxs(ee,{open:ks,onClose:()=>{ge(!1),be()},children:[e.jsx(se,{children:t.t("networks.details.addGroupDialog")}),e.jsx(te,{children:e.jsxs(c,{component:"form",sx:{pt:2},children:[e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-responsable1",name:"responsable1",label:t.t("networks.details.responsable1"),sx:{mb:2},required:!0,value:L||"",onChange:s=>x(s.target.value),autoComplete:"off",children:j.available_users.map(s=>e.jsx(A,{value:s.id||s._id,children:s.username},s.id||s._id))}),e.jsxs(v,{select:!0,fullWidth:!0,id:"network-details-responsable2",name:"responsable2",label:t.t("networks.details.responsable2Disabled"),sx:{mb:2},value:g||"",onChange:s=>N(s.target.value),disabled:!0,InputProps:{style:{backgroundColor:"#f5f5f5",color:"#666"}},helperText:t.t("common.actions.fieldTemporarilyDisabled"),children:[e.jsx(A,{value:"",children:t.t("common.actions.none")}),j.available_users.filter(s=>s._id!==L).map(s=>e.jsx(A,{value:s.id||s._id,children:s.username},s.id||s._id))]}),e.jsxs(v,{select:!0,fullWidth:!0,id:"network-details-qualification",name:"qualification",label:t.t("networks.details.responsibleQualification"),sx:{mb:2},required:!0,value:T||"",onChange:s=>fe(s.target.value),helperText:t.t("networks.details.qualificationAutoAssigned"),autoComplete:"off",children:[e.jsx(A,{value:"QUALIFICATION_12",children:"12"}),e.jsx(A,{value:"QUALIFICATION_144",children:"144"}),e.jsx(A,{value:"QUALIFICATION_1728",children:"1728"}),e.jsx(A,{value:"QUALIFICATION_20738",children:"20738"}),e.jsx(A,{value:"QUALIFICATION_248832",children:"248832"})]}),e.jsxs(v,{select:!0,fullWidth:!0,id:"network-details-superior",name:"superior",required:!0,label:t.t("networks.details.superior"),sx:{mb:2},value:m||"",onChange:s=>E(s.target.value),helperText:T?t.t("networks.details.selectSuperiorBasedOnQualification",{qualification:T.replace("QUALIFICATION_",""),count:$.length,plural:$.length>1?"s":""}):t.t("networks.details.selectQualificationFirst"),disabled:!T,autoComplete:"off",children:[$.map(s=>e.jsx(A,{value:s.id,children:s.label},s.id)),$.length===0&&T&&e.jsx(A,{disabled:!0,children:t.t("networks.details.noAvailableSuperiors")})]}),e.jsx(v,{fullWidth:!0,id:"network-details-group-name",name:"groupName",label:t.t("networks.details.nomGroupe"),sx:{mb:2},value:Ae||"",InputProps:{readOnly:!0},placeholder:t.t("networks.details.nameAutoGenerated"),helperText:t.t("networks.details.nameGeneratedFromResponsible"),autoComplete:"off"})]})}),e.jsxs(ae,{children:[e.jsx(R,{onClick:()=>{ge(!1),be()},children:t.t("networks.details.cancel")}),e.jsx(R,{variant:"contained",onClick:()=>et({responsable1:L,responsable2:g,qualification:T,superieur_hierarchique:m}),disabled:!C||!L||!T||!m,title:u(C),children:t.t("common.actions.add")})]})]}),e.jsxs(ee,{open:Ms,onClose:()=>{je(!1),ce(!1),Ve(!1),P({username:"",pseudo:"",email:"",password:"",role:"MEMBRE",genre:"",tranche_age:"",profession:"",ville_residence:"",origine:"",situation_matrimoniale:"",niveau_education:"",departement:"",departement_ids:[],qualification:"",telephone:"",adresse:"",image:""})},maxWidth:"sm",fullWidth:!0,children:[e.jsx(se,{children:t.t("networks.details.addMember")}),e.jsxs(te,{children:[e.jsxs(c,{sx:{pt:2,mb:2},children:[e.jsx(R,{variant:ne?"outlined":"contained",onClick:()=>ce(!1),sx:{mr:1},disabled:!l,title:u(C),children:t.t("networks.details.selectExistingMember")}),e.jsx(R,{variant:ne?"contained":"outlined",onClick:()=>ce(!0),disabled:!l,title:u(C),children:t.t("networks.details.createNewMember")})]}),e.jsx(c,{component:"form",sx:{pt:2},children:ne?e.jsxs(e.Fragment,{children:[e.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:3,p:2,border:"2px dashed var(--upload-dashed)",borderRadius:2,backgroundColor:"#fafafa",transition:"all 0.3s ease","&:hover":{borderColor:"#1976d2",backgroundColor:"#f5f5f5"}},children:[e.jsx(o,{variant:"subtitle1",sx:{mb:1.5,color:"primary.main",fontWeight:"bold",textAlign:"center"},children:t.t("auth.register.profileImage")}),y.image||qe?e.jsxs(c,{sx:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",mb:1.5},children:[e.jsx("img",{src:qe||cs(y.image),alt:"AperÃ§u de la photo de profil",style:{width:90,height:90,borderRadius:"50%",objectFit:"cover",border:"3px solid var(--white-border)",boxShadow:"0 2px 8px var(--network-shadow)",marginBottom:12}}),e.jsx(J,{size:"small",color:"error",onClick:Gs,disabled:!l,sx:{position:"absolute",top:-8,left:-8,bgcolor:"white",border:"2px solid",borderColor:"error.main","&:hover":{bgcolor:"error.light",color:"white"}},children:e.jsx(oe,{sx:{fontSize:14}})})]}):e.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:1.5},children:[e.jsx(c,{sx:{width:90,height:90,borderRadius:"50%",backgroundColor:"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",mb:1,border:"2px dashed #bdbdbd"},children:e.jsx(we,{sx:{fontSize:32,color:"#9e9e9e"}})}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{mb:1,textAlign:"center"},children:"Aucune photo sÃ©lectionnÃ©e"})]}),e.jsxs(R,{variant:"contained",component:"label",disabled:!l,size:"small",sx:{borderRadius:1.5,textTransform:"none",fontWeight:"bold",px:2,py:1,fontSize:"0.875rem",boxShadow:"0 2px 6px var(--network-blue-shadow)","&:hover":{boxShadow:"0 3px 8px var(--network-blue-hover-shadow)",transform:"translateY(-1px)"}},children:[y.image||qe?t.t("auth.register.changeImage"):t.t("auth.register.selectImage"),e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:Ps})]}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{mt:.5,textAlign:"center",fontSize:"0.7rem"},children:"JPG, PNG, GIF (max 5MB)"})]}),e.jsx(v,{fullWidth:!0,id:"network-details-member-username",name:"username",label:t.t("auth.register.username"),value:y.username,onChange:s=>P({...y,username:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"username"}),e.jsx(v,{fullWidth:!0,id:"network-details-member-pseudo",name:"pseudo",label:t.t("auth.register.pseudo"),value:y.pseudo,onChange:s=>P({...y,pseudo:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"nickname"}),e.jsx(v,{fullWidth:!0,id:"network-details-member-email",name:"email",label:t.t("auth.register.email"),type:"email",value:y.email,onChange:s=>P({...y,email:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"email"}),e.jsx(v,{fullWidth:!0,id:"network-details-member-telephone",name:"telephone",label:t.t("auth.register.telephone"),value:y.telephone,onChange:s=>P({...y,telephone:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"tel"}),e.jsx(v,{fullWidth:!0,id:"network-details-member-adresse",name:"adresse",label:t.t("auth.register.adresse"),value:y.adresse,onChange:s=>P({...y,adresse:s.target.value}),sx:{mb:2},disabled:!l,title:u(C),autoComplete:"street-address"}),e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-member-genre",name:"genre",label:t.t("auth.register.genre"),value:y.genre,onChange:s=>P({...y,genre:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"sex",children:us.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-member-tranche-age",name:"tranche_age",label:t.t("auth.register.ageRange"),value:y.tranche_age,onChange:s=>P({...y,tranche_age:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"bday",children:ms.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{fullWidth:!0,id:"network-details-member-profession",name:"profession",label:t.t("auth.register.profession"),value:y.profession,onChange:s=>P({...y,profession:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"organization-title"}),e.jsx(v,{fullWidth:!0,id:"network-details-member-ville-residence",name:"ville_residence",label:t.t("auth.register.villeResidence"),value:y.ville_residence,onChange:s=>P({...y,ville_residence:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"address-level2"}),e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-member-origine",name:"origine",label:t.t("auth.register.originCountry"),value:y.origine,onChange:s=>P({...y,origine:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"country",children:ps.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-member-situation-matrimoniale",name:"situation_matrimoniale",label:t.t("auth.register.situationMatrimoniale"),value:y.situation_matrimoniale,onChange:s=>P({...y,situation_matrimoniale:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"off",children:hs.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-member-niveau-education",name:"niveau_education",label:t.t("auth.register.educationLevel"),value:y.niveau_education,onChange:s=>P({...y,niveau_education:s.target.value}),sx:{mb:2},required:!0,disabled:!l,title:u(C),autoComplete:"off",children:xs.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-member-qualification",name:"qualification",label:t.t("auth.register.qualification"),value:y.qualification,onChange:s=>P({...y,qualification:s.target.value}),required:!0,disabled:!l,title:u(C),autoComplete:"off",children:fs.filter(s=>![t.t("qualifications.governance"),t.t("qualifications.networkResponsible"),t.t("qualifications.ecodim"),t.t("qualifications.ecodimResponsible")].includes(s.value)).map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(ht,{control:e.jsx(xt,{id:"network-details-member-sert-departement",name:"sert_departement",checked:He,onChange:s=>Ve(s.target.checked),disabled:!l,title:u(C)}),label:t.t("networks.details.sertDepartement"),sx:{mb:2}}),He&&e.jsxs(ns,{fullWidth:!0,sx:{mb:2},disabled:!l,children:[e.jsx(os,{id:"network-details-member-departments-label",children:t.t("auth.register.departments")}),e.jsx(ds,{id:"network-details-member-departments",name:"departement_ids",multiple:!0,value:y.departement_ids||[],onChange:s=>P({...y,departement_ids:s.target.value}),labelId:"network-details-member-departments-label",autoComplete:"off",renderValue:s=>e.jsx(c,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:s.map(r=>{const a=h.find(i=>(i.id||i._id)===r);return e.jsx(le,{label:a?a.nom:r,size:"small"},r)})}),children:h.map(s=>e.jsx(A,{value:s.id||s._id,children:s.nom},s.id||s._id))})]})]}):e.jsx(v,{select:!0,fullWidth:!0,id:"network-details-select-member",name:"selectedMember",label:t.t("networks.details.selectMember"),value:ue||"",onChange:s=>{De(s.target.value)},required:!0,disabled:!l,title:u(C),autoComplete:"off",children:j.available_users.filter(s=>![t.t("qualifications.governance"),t.t("qualifications.networkResponsible"),t.t("qualifications.ecodim"),t.t("qualifications.ecodimResponsible")].includes(s.qualification)).map(s=>e.jsxs(A,{value:s.id||s._id,children:[s.username," (",e.jsx(o,{component:"span",variant:"caption",sx:{fontWeight:"bold",fontSize:"0.75rem"},children:Ie(s.qualification)}),")"]},s.id||s._id))})})]}),e.jsxs(ae,{children:[e.jsx(R,{onClick:()=>{let s="";(p?.current_role||p?.role)!=="SUPER_ADMIN"&&(_?.id||_?._id?s=_.id||_._id:p?.eglise_locale&&(s=typeof p.eglise_locale=="object"?p.eglise_locale.id||p.eglise_locale._id:p.eglise_locale)),je(!1),ce(!1),P({username:"",pseudo:"",email:"",password:"",role:"MEMBRE",genre:"",tranche_age:"",profession:"",ville_residence:"",origine:"",situation_matrimoniale:"",niveau_education:"",eglise_locale:s,departement:"",departement_ids:[],qualification:"",telephone:"",adresse:"",image:""})},children:t.t("networks.details.cancel")}),e.jsx(R,{variant:"contained",onClick:s=>{if(ne)ss(y);else{if(!ue){k({open:!0,message:t.t("networks.details.selectMember"),severity:"error"});return}ss({user_id:ue})}},disabled:!l||(ne?!y.username||!y.email||!y.qualification:!ue),title:u(C),children:t.t("networks.details.addMember")})]})]}),e.jsxs(ee,{open:As,onClose:()=>ve(!1),onEnter:async()=>{if(Z)try{const s=Z.id||Z._id;if(!s){k({open:!0,message:t.t("networks.details.invalidGroupId"),severity:"error"});return}const r=await G.groups.getById(s),a=r.data?.data||r.data||{};x(a.responsable1?typeof a.responsable1=="object"?a.responsable1.id||a.responsable1._id:a.responsable1:""),N(a.responsable2?typeof a.responsable2=="object"?a.responsable2.id||a.responsable2._id:a.responsable2:"")}catch{x(""),N(""),k({open:!0,message:t.t("errors.api.getGroup"),severity:"error"})}},children:[e.jsx(se,{children:t.t("networks.details.editGR")}),e.jsx(te,{children:e.jsxs(c,{component:"form",sx:{pt:2},children:[e.jsx(v,{select:!0,fullWidth:!0,label:t.t("networks.details.responsable1"),value:L,onChange:s=>x(s.target.value),sx:{mb:2,minWidth:250},required:!0,children:j.available_users.map(s=>e.jsxs(A,{value:s.id||s._id,children:[s.username," (",e.jsx(o,{component:"span",variant:"caption",sx:{fontWeight:"bold",fontSize:"0.75rem"},children:Ie(s.qualification)}),")"]},s.id||s._id))}),e.jsxs(v,{select:!0,fullWidth:!0,label:t.t("networks.details.responsable2"),value:g,onChange:s=>N(s.target.value),sx:{mb:2,minWidth:250},disabled:!0,InputProps:{style:{backgroundColor:"#f5f5f5",color:"#666"}},helperText:t.t("common.actions.fieldTemporarilyDisabled"),children:[e.jsx(A,{value:"",children:t.t("common.actions.none")}),j.available_users.map(s=>e.jsxs(A,{value:s.id||s._id,children:[s.username," (",e.jsx(o,{component:"span",variant:"caption",sx:{fontWeight:"bold",fontSize:"0.75rem"},children:Ie(s.qualification)}),")"]},s.id||s._id))]})]})}),e.jsxs(ae,{children:[e.jsx(R,{onClick:()=>{ve(!1),x(""),N("")},children:t.t("networks.details.cancel")}),e.jsx(R,{variant:"contained",onClick:()=>{const s=Z?.id||Z?._id;if(!s){k({open:!0,message:t.t("networks.details.invalidGroupId"),severity:"error"});return}Vs({id:s,responsable1_id:L,responsable2_id:g||null})},color:"primary",disabled:!l||!L,title:u(l),children:t.t("common.actions.edit")})]})]}),e.jsxs(ee,{open:Ts,onClose:()=>ye(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(se,{children:t.t("networks.details.editMember")}),e.jsx(te,{children:e.jsxs(c,{component:"form",sx:{pt:2},children:[e.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:3,p:2,backgroundColor:"#f8f9fa",borderRadius:1,border:"2px dashed var(--upload-dashed)",boxShadow:"0 1px 8px var(--upload-shadow-light)"},children:[e.jsx(o,{variant:"subtitle1",sx:{mb:2,fontWeight:"bold",color:"primary.main",textAlign:"center"},children:t.t("auth.register.profileImage")}),w.image||Te?e.jsxs(c,{sx:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",mb:1.5},children:[e.jsx("img",{src:Te||cs(w.image),alt:"AperÃ§u de la photo de profil",style:{width:90,height:90,borderRadius:"50%",objectFit:"cover",border:"3px solid #fff",boxShadow:"0 1px 8px rgba(0,0,0,0.15)",marginBottom:12}}),e.jsx(J,{size:"small",color:"error",onClick:Ns,disabled:!b,sx:{position:"absolute",top:-8,left:-8,bgcolor:"white",border:"2px solid",borderColor:"error.main","&:hover":{bgcolor:"error.light",color:"white"}},children:e.jsx(oe,{sx:{fontSize:14}})})]}):e.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:1.5},children:[e.jsx(c,{sx:{width:90,height:90,borderRadius:"50%",backgroundColor:"#e0e0e0",display:"flex",alignItems:"center",justifyContent:"center",mb:1,border:"2px dashed #ccc"},children:e.jsx(we,{sx:{fontSize:32,color:"#999"}})}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Aucune image sÃ©lectionnÃ©e"})]}),e.jsxs(R,{variant:"outlined",component:"label",size:"small",disabled:!b,sx:{borderRadius:1.5,textTransform:"none",fontWeight:"bold",fontSize:"0.75rem",py:.5,px:1.5,borderColor:"primary.main",color:"primary.main","&:hover":{backgroundColor:"primary.light",color:"white",boxShadow:"0 3px 8px rgba(25, 118, 210, 0.4)",transform:"translateY(-1px)"}},children:[w.image||Te?t.t("auth.register.changeImage"):t.t("auth.register.selectImage"),e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:Os})]}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{mt:.5,fontSize:"0.7rem",textAlign:"center"},children:"Formats acceptÃ©s: JPG, PNG, GIF (max 5MB)"})]}),e.jsx(v,{fullWidth:!0,label:t.t("networks.details.username"),value:w.username,onChange:s=>F({...w,username:s.target.value}),sx:{mb:2},required:!0,disabled:!b,title:u(b)}),e.jsx(v,{fullWidth:!0,label:t.t("networks.details.pseudo"),value:w.pseudo,onChange:s=>F({...w,pseudo:s.target.value}),sx:{mb:2},disabled:!b,title:u(b)}),e.jsx(v,{fullWidth:!0,label:t.t("networks.details.email"),value:w.email,onChange:s=>F({...w,email:s.target.value}),sx:{mb:2},disabled:!b,title:u(b)}),e.jsx(v,{fullWidth:!0,label:t.t("networks.details.telephone"),value:w.telephone,onChange:s=>F({...w,telephone:s.target.value}),sx:{mb:2},disabled:!b,title:u(b)}),e.jsx(v,{fullWidth:!0,label:t.t("networks.details.address"),value:w.adresse,onChange:s=>F({...w,adresse:s.target.value}),sx:{mb:2},disabled:!b,title:u(b)}),e.jsx(v,{select:!0,fullWidth:!0,label:t.t("networks.details.genre"),value:w.genre,onChange:s=>F({...w,genre:s.target.value}),sx:{mb:2},disabled:!b,title:u(b),children:us.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{select:!0,fullWidth:!0,label:t.t("networks.details.ageRange"),value:w.tranche_age,onChange:s=>F({...w,tranche_age:s.target.value}),sx:{mb:2},disabled:!b,title:u(b),children:ms.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{fullWidth:!0,label:t.t("networks.details.profession"),value:w.profession,onChange:s=>F({...w,profession:s.target.value}),sx:{mb:2},disabled:!b,title:u(b)}),e.jsx(v,{fullWidth:!0,label:t.t("networks.details.residenceCity"),value:w.ville_residence,onChange:s=>F({...w,ville_residence:s.target.value}),sx:{mb:2},disabled:!b,title:u(b)}),e.jsx(v,{select:!0,fullWidth:!0,label:t.t("networks.details.origin"),value:w.origine,onChange:s=>F({...w,origine:s.target.value}),sx:{mb:2},disabled:!b,title:u(b),children:ps.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{select:!0,fullWidth:!0,label:t.t("networks.details.maritalStatus"),value:w.situation_matrimoniale,onChange:s=>F({...w,situation_matrimoniale:s.target.value}),sx:{mb:2},disabled:!b,title:u(b),children:hs.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsx(v,{select:!0,fullWidth:!0,label:t.t("networks.details.educationLevel"),value:w.niveau_education,onChange:s=>F({...w,niveau_education:s.target.value}),sx:{mb:2},disabled:!b,title:u(b),children:xs.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))}),e.jsxs(ns,{fullWidth:!0,sx:{mb:2},disabled:!b,children:[e.jsx(os,{children:t.t("auth.register.departments")}),e.jsx(ds,{multiple:!0,value:w.departement_ids||[],onChange:s=>F({...w,departement_ids:s.target.value}),renderValue:s=>e.jsx(c,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:s.map(r=>{const a=h.find(i=>(i.id||i._id)===r);return e.jsx(le,{label:a?a.nom:r,size:"small"},r)})}),children:h.map(s=>e.jsx(A,{value:s.id||s._id,children:s.nom},s.id||s._id))})]}),e.jsx(v,{select:!0,fullWidth:!0,label:t.t("networks.details.qualification"),value:w.qualification,onChange:s=>F({...w,qualification:s.target.value}),sx:{mb:2},disabled:!b,title:u(b),children:fs.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))})]})}),e.jsxs(ae,{children:[e.jsx(R,{onClick:()=>ye(!1),children:t.t("networks.details.cancel")}),e.jsx(R,{variant:"contained",onClick:()=>st(w),disabled:!b,title:u(b),children:t.t("common.actions.edit")})]})]})]}),e.jsx(bs,{open:Ys,title:t.t("networks.details.deleteGr"),content:t.t("networks.details.deleteGrContent"),onClose:Zs,onConfirm:Ks}),e.jsx(bs,{open:tt,title:t.t("networks.details.deleteMember"),content:t.t("networks.details.deleteMemberContent"),onClose:lt,onConfirm:it}),e.jsx(Cs,{open:me.open,autoHideDuration:2e3,onClose:()=>k({...me,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(he,{onClose:()=>k({...me,open:!1}),severity:me.severity,sx:{width:"100%"},children:me.message})}),e.jsx(St,{open:Es,onClose:Qs,onSave:$s,networkData:j,isLoading:Ws}),e.jsx(kt,{open:Ds,onClose:Hs,onSave:Bs,networkData:j,isLoading:qs}),e.jsx(At,{open:Rs,onClose:()=>$e(!1),networkData:j})]})}):e.jsx(c,{sx:{minHeight:"100vh",bgcolor:"background.default",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(o,{variant:"h6",color:"error",children:t.t("auth.loginRequired")})})};export{Bt as default};
