"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[830],{22094:(e,t,r)=>{r.d(t,{A:()=>d});r(65043);var o=r(53969),i=r(94799),s=r(55895),a=r(45350),n=r(56266),l=r(70579);const d=e=>{let{allowedRoles:t=[],children:r,fallback:d=null,showMessage:u=!0}=e;const c=(0,a.S)();return t.some(e=>{switch(e){case"SUPER_ADMIN":return c.isSuperAdmin;case"ADMIN":return c.isAdmin;case"MANAGER":return c.isManager;case"SUPERVISEUR":return c.isSuperviseur;case"COLLECTEUR_CULTE":return c.isCollecteurCulte;case"COLLECTEUR_RESEAUX":return c.isCollecteurReseaux;default:return!1}})?r:d||(u?(0,l.jsx)(o.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",p:3},children:(0,l.jsxs)(i.A,{elevation:3,sx:{p:4,textAlign:"center",maxWidth:500},children:[(0,l.jsx)(s.A,{variant:"h5",color:"error",gutterBottom:!0,children:n.A.t("errors.accessDenied")}),(0,l.jsx)(s.A,{variant:"body1",color:"text.secondary",paragraph:!0,children:n.A.t("errors.insufficientPermissions")}),(0,l.jsx)(s.A,{variant:"body2",color:"text.secondary",children:n.A.t("errors.contactAdmin")})]})}):null)}},37251:(e,t,r)=>{r.d(t,{h:()=>s});var o=r(89379),i=r(65043);const s=()=>{const[e,t]=(0,i.useState)({open:!1,message:"",severity:"info"}),r=(0,i.useCallback)(function(e){t({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"})},[]),s=(0,i.useCallback)(()=>{t(e=>(0,o.A)((0,o.A)({},e),{},{open:!1}))},[]),a=(0,i.useCallback)(e=>{r(e,"success")},[r]),n=(0,i.useCallback)(e=>{r(e,"error")},[r]),l=(0,i.useCallback)(e=>{r(e,"warning")},[r]),d=(0,i.useCallback)(e=>{r(e,"info")},[r]);return{notification:e,showNotification:r,hideNotification:s,showSuccess:a,showError:n,showWarning:l,showInfo:d}}},45492:(e,t,r)=>{r.d(t,{A:()=>l});var o=r(53969),i=r(94799),s=r(55895),a=r(56266),n=r(70579);const l=e=>{let{error:t,onRetry:r}=e;return(0,n.jsx)(o.A,{sx:{minHeight:"60vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",bgcolor:"background.default"},children:(0,n.jsxs)(i.A,{elevation:3,sx:{p:4,bgcolor:"#fff3f3",border:"1px solid #f44336",borderRadius:3,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,n.jsxs)("svg",{width:"56",height:"56",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{marginBottom:16},children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"12",fill:"#f44336",fillOpacity:"0.1"}),(0,n.jsx)("path",{d:"M12 7v5",stroke:"#f44336",strokeWidth:"2",strokeLinecap:"round"}),(0,n.jsx)("circle",{cx:"12",cy:"16",r:"1",fill:"#f44336"})]}),(0,n.jsx)(s.A,{variant:"h5",sx:{color:"error.main",fontWeight:"bold",mb:1},children:a.A.t("loading.error")}),(0,n.jsx)(s.A,{variant:"subtitle1",sx:{color:"error.main",mb:2},children:t}),(0,n.jsx)("button",{style:{padding:"8px 24px",background:"#f44336",color:"#fff",border:"none",borderRadius:4,fontWeight:"bold",cursor:"pointer",fontSize:16},onClick:r||(()=>window.location.reload()),children:a.A.t("common.actions.retry")})]})})}},95830:(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var o=r(65043),i=r(56266),s=r(77210),a=r(63516),n=r(80899),l=r(94799),d=r(53969),u=r(55895),c=r(53089),m=r(24343),h=r(47471),v=r(12097),x=r(33023),f=r(81911),p=r(78776),b=r(9200),_=r(85877),A=r(70579);const g=e=>{let{open:t,onClose:r,title:o="Succ\xe8s",content:i="L'op\xe9ration a r\xe9ussi."}=e;return(0,A.jsxs)(x.A,{open:t,onClose:r,"aria-labelledby":"success-dialog-title","aria-describedby":"success-dialog-description",children:[(0,A.jsx)(f.A,{id:"success-dialog-title",sx:{color:"success.main"},children:o}),(0,A.jsx)(p.A,{children:(0,A.jsx)(b.A,{id:"success-dialog-description",children:i})}),(0,A.jsx)(_.A,{children:(0,A.jsx)(v.A,{onClick:r,autoFocus:!0,variant:"contained",color:"success",children:"OK"})})]})};var C=r(15521),j=r(45492),k=r(82656),y=r(41894),W=r(37251),q=r(98914),L=r(22094);const T=n.Ik({culte:n.Yj().required("Le type de culte est requis"),orateur:n.Yj().required("L'orateur est requis"),date:n.p6().required("La date est requise"),total_adultes:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le nombre d'adultes est requis"),total_enfants:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le nombre d'enfants est requis"),total_chantres:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le nombre de chantres est requis"),total_protocoles:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le nombre de protocoles est requis"),total_multimedia:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le nombre de multimedia est requis"),total_respo_ecodim:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le responsable ECODIM est requis"),total_animateurs_ecodim:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le nombre d'animateurs ECODIM est requis"),total_enfants_ecodim:n.ai().min(0,"Le nombre doit \xeatre positif").required("Le nombre d'enfants ECODIM est requis"),collecteur_culte:n.Yj().required("Le collecteur est requis"),superviseur:n.Yj().required("Le superviseur est requis"),invitationYoutube:n.ai().min(0,"Le nombre doit \xeatre positif"),invitationTiktok:n.ai().min(0,"Le nombre doit \xeatre positif"),invitationInstagram:n.ai().min(0,"Le nombre doit \xeatre positif"),invitationPhysique:n.ai().min(0,"Le nombre doit \xeatre positif")}),E=()=>{const[e,t]=(0,o.useState)(!1),[r,n]=(0,o.useState)(!0),[x,f]=(0,o.useState)(null),[p,b]=(0,o.useState)([]),[_,E]=(0,o.useState)([]),{selectedChurch:S}=(0,q.w)(),{showError:w}=(0,W.h)();(0,o.useEffect)(()=>{(async()=>{try{var e,t;const r=await y.apiService.users.getAll({role:"SUPERVISEUR"});b((null===(e=r.data)||void 0===e?void 0:e.data)||r.data||[]);const o=await y.apiService.users.getAll({role:"COLLECTEUR_CULTE"});E((null===(t=o.data)||void 0===t?void 0:t.data)||o.data||[]),n(!1)}catch(a){var r,o;(0,s.hS)(a,i.A.t("errors.api.loadUsers"));f((null===(r=a.response)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.message)||a.message||i.A.t("errors.api.loadUsers")),n(!1)}})()},[]);const I=(0,a.Wx)({initialValues:{culte:"",orateur:"",date:new Date,total_adultes:"",total_enfants:"",total_chantres:"",total_protocoles:"",total_multimedia:"",total_respo_ecodim:"",total_animateurs_ecodim:"",total_enfants_ecodim:"",collecteur_culte:null,superviseur:null,invitationYoutube:0,invitationTiktok:0,invitationInstagram:0,invitationPhysique:0},validationSchema:T,onSubmit:async e=>{try{if(null===S||void 0===S||!S.id)return void w(i.A.t("errors.api.selectChurch"));const r={date:e.date,culte:e.culte,orateur:e.orateur,eglise_id:S.id,nombre_present:Number(e.total_adultes)+Number(e.total_enfants),responsable_id:e.superviseur||null,total_adultes:Number(e.total_adultes),total_enfants:Number(e.total_enfants),total_chantres:Number(e.total_chantres),total_protocoles:Number(e.total_protocoles),total_multimedia:Number(e.total_multimedia),total_respo_ecodim:Number(e.total_respo_ecodim),total_animateurs_ecodim:Number(e.total_animateurs_ecodim),total_enfants_ecodim:Number(e.total_enfants_ecodim),collecteur_culte:e.collecteur_culte,superviseur:e.superviseur,invitationYoutube:Number(e.invitationYoutube),invitationTiktok:Number(e.invitationTiktok),invitationInstagram:Number(e.invitationInstagram),invitationPhysique:Number(e.invitationPhysique)};await y.apiService.services.create(r),t(!0)}catch(x){var r,o,s,a;400===(null===(r=x.response)||void 0===r?void 0:r.status)?w(i.A.t("errors.api.invalidData")):500===(null===(o=x.response)||void 0===o?void 0:o.status)?w(i.A.t("errors.api.serverError")):null!==(s=x.response)&&void 0!==s&&null!==(a=s.data)&&void 0!==a&&a.message?w(x.response.data.message):w(x.message||i.A.t("errors.api.createService"))}}});return r?(0,A.jsx)("div",{children:"Chargement..."}):x?(0,A.jsx)(j.A,{error:x,title:i.A.t("errors.loading")}):null!==S&&void 0!==S&&S.id?(0,A.jsx)(L.A,{allowedRoles:["SUPER_ADMIN","ADMIN","MANAGER","COLLECTEUR_CULTE"],children:(0,A.jsxs)(l.A,{"data-aos":"fade-up",elevation:3,sx:{p:4},children:[(0,A.jsx)("form",{onSubmit:I.handleSubmit,children:(0,A.jsxs)(c.A,{container:!0,spacing:3,children:[(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,select:!0,name:"culte",label:i.A.t("services.list.typeCulte"),value:I.values.culte,onChange:I.handleChange,error:I.touched.culte&&Boolean(I.errors.culte),helperText:I.touched.culte&&I.errors.culte,children:k.ze.map(e=>(0,A.jsx)(h.A,{value:e.value,children:e.label},e.value))})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,type:"date",name:"date",label:i.A.t("services.list.dateCulte"),value:(0,C.GP)(I.values.date,"yyyy-MM-dd"),onChange:e=>I.setFieldValue("date",new Date(e.target.value)),error:I.touched.date&&Boolean(I.errors.date),helperText:I.touched.date&&I.errors.date,InputLabelProps:{shrink:!0}})}),(0,A.jsx)(c.A,{item:!0,xs:12,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"orateur",label:i.A.t("services.list.orateur"),value:I.values.orateur,onChange:I.handleChange,error:I.touched.orateur&&Boolean(I.errors.orateur),helperText:I.touched.orateur&&I.errors.orateur})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_adultes",label:i.A.t("services.list.nombreAdultes"),type:"number",value:I.values.total_adultes,onChange:I.handleChange,error:I.touched.total_adultes&&Boolean(I.errors.total_adultes),helperText:I.touched.total_adultes&&I.errors.total_adultes})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_enfants",label:i.A.t("services.list.nombreEnfants"),type:"number",value:I.values.total_enfants,onChange:I.handleChange,error:I.touched.total_enfants&&Boolean(I.errors.total_enfants),helperText:I.touched.total_enfants&&I.errors.total_enfants})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:4,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_chantres",label:i.A.t("services.list.nombreChantres"),type:"number",value:I.values.total_chantres,onChange:I.handleChange,error:I.touched.total_chantres&&Boolean(I.errors.total_chantres),helperText:I.touched.total_chantres&&I.errors.total_chantres})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:4,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_protocoles",label:i.A.t("services.list.nombreProtocoles"),type:"number",value:I.values.total_protocoles,onChange:I.handleChange,error:I.touched.total_protocoles&&Boolean(I.errors.total_protocoles),helperText:I.touched.total_protocoles&&I.errors.total_protocoles})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:4,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_multimedia",label:i.A.t("services.list.nombreMultimedia"),type:"number",value:I.values.total_multimedia,onChange:I.handleChange,error:I.touched.total_multimedia&&Boolean(I.errors.total_multimedia),helperText:I.touched.total_multimedia&&I.errors.total_multimedia})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:4,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_respo_ecodim",label:i.A.t("services.list.responsableEcodim"),type:"number",value:I.values.total_respo_ecodim,onChange:I.handleChange,error:I.touched.total_respo_ecodim&&Boolean(I.errors.total_respo_ecodim),helperText:I.touched.total_respo_ecodim&&I.errors.total_respo_ecodim})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:4,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_animateurs_ecodim",label:i.A.t("services.list.nombreAnimateurs"),type:"number",value:I.values.total_animateurs_ecodim,onChange:I.handleChange,error:I.touched.total_animateurs_ecodim&&Boolean(I.errors.total_animateurs_ecodim),helperText:I.touched.total_animateurs_ecodim&&I.errors.total_animateurs_ecodim})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:4,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"total_enfants_ecodim",label:"".concat(i.A.t("services.list.nombreEnfants")," ").concat(i.A.t("services.list.enfEcodim")),type:"number",value:I.values.total_enfants_ecodim,onChange:I.handleChange,error:I.touched.total_enfants_ecodim&&Boolean(I.errors.total_enfants_ecodim),helperText:I.touched.total_enfants_ecodim&&I.errors.total_enfants_ecodim})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsxs)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,select:!0,name:"collecteur_culte",label:i.A.t("services.form.collector"),value:I.values.collecteur_culte||"",onChange:I.handleChange,error:I.touched.collecteur_culte&&Boolean(I.errors.collecteur_culte),helperText:I.touched.collecteur_culte&&I.errors.collecteur_culte,required:!0,children:[(0,A.jsx)(h.A,{value:"",children:i.A.t("services.list.selectCollecteur")}),_&&_.length>0?_.map(e=>(0,A.jsx)(h.A,{value:e._id||e.id,children:e.username||e.pseudo||i.A.t("common_text.unknownName")},e._id||e.id)):(0,A.jsx)(h.A,{disabled:!0,children:i.A.t("services.list.noCollecteur")})]})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsxs)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,select:!0,name:"superviseur",label:i.A.t("services.form.supervisor"),value:I.values.superviseur||"",onChange:I.handleChange,error:I.touched.superviseur&&Boolean(I.errors.superviseur),helperText:I.touched.superviseur&&I.errors.superviseur,required:!0,children:[(0,A.jsx)(h.A,{value:"",children:i.A.t("services.list.selectSuperviseur")}),p&&p.length>0?p.map(e=>(0,A.jsx)(h.A,{value:e._id||e.id,children:e.username||e.pseudo||i.A.t("common_text.unknownName")},e._id||e.id)):(0,A.jsx)(h.A,{disabled:!0,children:i.A.t("services.list.noSuperviseur")})]})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"invitationYoutube",label:i.A.t("services.list.invitationsYoutube"),type:"number",value:I.values.invitationYoutube,onChange:I.handleChange,error:I.touched.invitationYoutube&&Boolean(I.errors.invitationYoutube),helperText:I.touched.invitationYoutube&&I.errors.invitationYoutube})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"invitationTiktok",label:i.A.t("services.list.invitationsTiktok"),type:"number",value:I.values.invitationTiktok,onChange:I.handleChange,error:I.touched.invitationTiktok&&Boolean(I.errors.invitationTiktok),helperText:I.touched.invitationTiktok&&I.errors.invitationTiktok})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"invitationInstagram",label:i.A.t("services.list.invitationsInstagram"),type:"number",value:I.values.invitationInstagram,onChange:I.handleChange,error:I.touched.invitationInstagram&&Boolean(I.errors.invitationInstagram),helperText:I.touched.invitationInstagram&&I.errors.invitationInstagram})}),(0,A.jsx)(c.A,{item:!0,xs:12,sm:6,children:(0,A.jsx)(m.A,{sx:{minWidth:250,backgroundColor:"#fdfdfd"},fullWidth:!0,name:"invitationPhysique",label:i.A.t("services.list.invitationsPhysiques"),type:"number",value:I.values.invitationPhysique,onChange:I.handleChange,error:I.touched.invitationPhysique&&Boolean(I.errors.invitationPhysique),helperText:I.touched.invitationPhysique&&I.errors.invitationPhysique})}),(0,A.jsx)(c.A,{item:!0,xs:12,children:(0,A.jsxs)(d.A,{display:"flex",justifyContent:"flex-end",gap:2,sx:{mt:1,right:0},children:[(0,A.jsx)(v.A,{variant:"outlined",color:"secondary",onClick:()=>I.resetForm(),children:i.A.t("common.actions.reset")}),(0,A.jsx)(v.A,{type:"submit",variant:"contained",color:"primary",children:i.A.t("common.actions.save")})]})})]})}),(0,A.jsx)(g,{open:e,onClose:()=>{t(!1),I.resetForm()},title:i.A.t("success.success"),content:i.A.t("success.serviceCreated")})]})}):(0,A.jsx)(l.A,{"data-aos":"fade-up",elevation:3,sx:{p:4},children:(0,A.jsxs)(d.A,{sx:{textAlign:"center",py:4},children:[(0,A.jsx)(u.A,{variant:"h6",color:"error",gutterBottom:!0,children:i.A.t("home.noChurchSelected")}),(0,A.jsx)(u.A,{variant:"body1",children:i.A.t("home.selectChurchForService")})]})})}}}]);
//# sourceMappingURL=830.ddffd9c7.chunk.js.map